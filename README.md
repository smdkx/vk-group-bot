# VK Group Bot
### Описание

Бот для сообщества ВКонтакте. Файл ```group_bot.js``` отвечает за бота с генерацией записей на стену сообщества с рандомной цитатой из списка, рандомным номером бочонка и отсчетом до ближайшей даты в днях (на текущий момент там отсчет до Нового года). Файл ```mes_bot.js``` отвечает уже за чат-бота, через него можно управлять первым ботом для ручной генерации записи (панель управления). Присутствует админка, команды для нее, система блокировки и логирование действий пользователя. Дополнительно имеются функции по типу запроса админки, отправка мемных картинок, возможность узнать свой VK ID. Файл ```piar_bot.js``` отвечает за рассылку постов в указанных сообществах.

## Начало работы

Склонируйте репозиторий в нужную директорию: 

```sh
git clone https://github.com/smdkx/vk-group-bot.git <name folder>
```

Установите пакеты:

```sh
cd <name folder>
npm install
```

В файле ```.env.example``` (следует переименовать в .env) присутствуют основные настройки бота:

- ```GROUP_ID``` отвечает за ID сообщества, с которым будет работать бот и генерировать записи.
- ```MONGODB``` отвечает за настройку доступа и синхронизацию базы данных с ботом. По умолчанию создается база данных с названием ```vk_bot``` и используется коллекция ```users``` с хранением данных.
- ```TOKEN_GROUP``` отвечает за токен сообщества для работы чат-бота. Создаем ключ доступа в настройках сообщества с соответсвующими правами.
- ```TOKEN_USER``` отвечает за токен пользователя, от лица которого осуществляется генерация записи и ее постинг на стену сообщества. Требуются права доступа: wall. Подробнее: https://dev.vk.com/ru/method/wall.post

В настройках **Long Poll API** сообщества не забываем установить корректные типы событий для работы бота, иначе он может попросту не работать.

В файле ```config.js``` указаны основные переменные и их значения:

- ```ADMIN_VK``` ID пользователя, которому будут приходить запросы прав администратора.
- ```DELAY_BETWEEN_POSTS``` отвечает за таймаут между публикацией следующей записи при использовании ```piar_bot.js```.
- ```RESTART_DELAY``` после публикации записей в ```piar_bot.js``` запускается таймер (по дефолту 10 минут) для перезапуска скрипта
- ```RETRY_ATTEMPTS``` попытки повторной публикации записи, если произошла ошбика (по умолчанию 3 попытки)
- ```RETRY_DELAY_MS``` через какое время будет совершена повторная попытка публикации записи (по умолчанию 5 секунд)
- ```MIN_VALUE``` минимальное число, которое может выпасть при генерации записи
- ```MAX_VALUE``` максимальное число, которое может выпасть при генерации записи

## Как использовать

Для запуска бота используется:

```sh
cd <name folder>
node group_bot.js
node mes_bot.js
node piar_bot.js
```

Made with ❤️ by [Sergey Ushakov](https://github.com/smdkx)